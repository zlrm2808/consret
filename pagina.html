<!DOCTYPE html>
<html>
    <head>
        <title></title>
        
<meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="librerias/bootstrap/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="librerias/datatable/bootstrap.css">
<link rel="stylesheet" type="text/css" href="librerias/datatable/dataTables.bootstrap4.min.css">
<link rel="stylesheet" type="text/css" href="librerias/alertify/css/alertify.css">
<link rel="stylesheet" type="text/css" href="librerias/alertify/css/themes/bootstrap.css">
<link rel="stylesheet" type="text/css" href="librerias/fontawesome/css/font-awesome.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="./style.css">
<link rel="stylesheet"  href="./style_consulta.css">
<script src="librerias/jquery.min.js"></script>
<script src="librerias/bootstrap/popper.min.js"></script>
<script src="librerias/bootstrap/bootstrap.min.js"></script>
<script src="librerias/datatable/jquery.dataTables.min.js"></script>
<script src="librerias/datatable/dataTables.bootstrap4.min.js"></script>
<script src="librerias/alertify/alertify.js"></script>
            </head>
    <body>
        <div class="container">
            <div class="card">
                <div class="t9"><img src="./logo2.jpg">Avicola La Providencia,C.A.</div>
                <br> </br>
                <p></p>
                <div class="pr">
                    Fecha: 08-08-2022                </div>
                <p></p>
            </div>
            <input type="button" class="btn btn-info btn-round" value="Cerrar" style="float: right; margin-top:5px; margin-left:5px;" onClick="location.href = '../menu1.php?usu=J306953558'"></input>  
            <div class="pt">
                Comprobante de Retencion del Impuesto al Valor Agregado
            </div>
            <div class="card">
                <div id="tablaDatatable"></div>
            </div>
        </div>
        <div class="loading"></div> 

    </body>
</html>
<script type="text/javascript">
    $(document).ready(function () {
        $('#btnAgregarnuevo').click(function () {
            datos = $('#frmnuevo').serialize();
            $.ajax({
                type: "POST",
                data: datos,
                url: "procesos/agregar.php",
                success: function (r) {
                    alert(r);
                    if (r == 1) {
                        $('#frmnuevo')[0].reset();
                        //$('#tablaDatatable').load('tabla_ret.php');
                        $('#tablaDatatable').load('tabla_ret.php?rif=J306953558');
                        alertify.success("agregado con exito :D");
                    } else {
                        $('#frmnuevo')[0].reset();
                        //$('#tablaDatatable').load('tabla_ret.php');
                        $('#tablaDatatable').load('tabla_ret.php?rif=J306953558');
                        alertify.error("Fallo al agregar :(");
                    }
                }
            });
        });

    });
</script>
<script type="text/javascript">
    $(document).ready(function () {
        //$('#tablaDatatable').load('tabla_ret.php');
        $('#tablaDatatable').load('tabla_ret.php?rif=J306953558');
    });
</script>

<script>
//When the page has loaded.
    $(document).on('click', '.imprime', function () {
        var id = $(this).val();
        var rif = $('#rif' + id).text();
        var nrofac = $('#nrofac' + id).text();
        var nrocom = $('#nrocom' + id).text();


        $(document).ready(function () {

            //Perform Ajax request.
            var parametros = {
                id: id,
                rif: rif,
                nrofac: nrofac,
                nrocom: nrocom

            };
            $.ajax({
                data: parametros, //datos que se envian a traves de ajax
                url: 'cuenta_impresion.php', //archivo que recibe la peticion                
                type: 'post', //método de envio
                cache: false,
                async: true,
                success: function () {

                

           // });
            $.ajax({
                data: parametros, //datos que se envian a traves de ajax
                url: 'dompdf/ret_iva.php', //archivo que recibe la peticion                
                type: 'post', //método de envio
                cache: false,
                async: true,

                beforeSend: function () {
                    location.href = 'dompdf/ret_iva.php?rif=' + rif + '&nrofac=' + nrofac;
                    $(".loading").show();

                },
                success: function () {
                    $('#tablaDatatable').load('tabla_ret.php?rif=' + rif);
                    $(".loading").hide();

                }

            });
                }
              });  
               
        });
    });
</script>
<style> 
        .loading {
        position: fixed;
        left: 40px;
        top: 40px;
        width: 100%;
        height: 100%;
        z-index: 9999;
        background: url('cargando.gif') 50% 50% no-repeat rgb(249,249,249);
        opacity: .8;
        display: none;
    }</style>